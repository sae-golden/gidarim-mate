# 시험관메이트 - UI 수정 요청 4가지

## 1. 각 페이지 상단 타이틀 매칭

### 현재 문제
- 기록 탭 상단에 "치료 기록"으로 표시됨
- 하단바 명칭과 불일치

### 수정 요청
각 페이지 상단 타이틀을 하단바 명칭과 일치시키기

| 하단바 | 페이지 상단 타이틀 |
|--------|-------------------|
| 홈 | (인사말 유지) |
| 캘린더 | 캘린더 |
| 약물추가 | 약물 추가 (또는 새 약 추가) |
| 기록 | 기록 |
| 설정 | 설정 |

```
Before:
┌─────────────────────────────────────────┐
│ 치료 기록                               │
│ 1차 시도                                │

After:
┌─────────────────────────────────────────┐
│ 기록                                    │
│ 1차 시도                                │
```

---

## 2. 전체 앱 민트색 제거

### 현재 문제
- 여러 페이지/팝업에서 민트색 사용 중
- 앱 톤앤매너(보라색)와 안 맞음

### 수정 요청
**모든 페이지, 팝업에서 민트색 제거**

민트색 → 대체 색상:
- 완료/성공 표시: 민트 → **연보라** 또는 **초록(#10B981)**
- 강조 뱃지: 민트 → **연보라(#E9D5FF)** 또는 **코랄핑크**
- 정보 박스: 민트 배경 → **연보라 배경** 또는 **연노랑(#FEF3C7)**

### 적용 위치
- [x] 홈 > "오늘도 수고했어요" 뱃지
- [x] 기록 탭 > 동결 배아 안내 박스
- [x] 캘린더 > 완료 표시 점
- [x] 모든 팝업/바텀시트
- [x] 체크 아이콘 배경

---

## 3. 홈 "곧 만나요" ↔ 기록 탭 동기화

### 현재 문제
- 기록 탭의 진행 단계와 홈의 "곧 만나요"가 연동 안 됨

### 수정 요청
기록 탭의 치료 단계 데이터 기반으로 홈 "곧 만나요" 자동 업데이트

### 로직
```dart
// 기록 탭에서 다음 예정 단계 가져오기
UpcomingEvent? getNextEvent(TreatmentCycle cycle) {
  // 1. 진행 중이거나 예정인 단계 중 날짜가 있는 것 찾기
  for (var stage in cycle.stages) {
    if (stage.status != StageStatus.completed && stage.date != null) {
      return UpcomingEvent(
        icon: getStageIcon(stage.type),
        title: getStageTitle(stage.type),
        subtitle: getStageSubtitle(stage.type),
        dDay: calculateDDay(stage.date!),
      );
    }
  }
  return null;
}

// 단계별 표시 정보
Map<StageType, Map<String, String>> stageInfo = {
  StageType.stimulation: {
    'title': '과배란 진행중',
    'subtitle': '주사 기간',
  },
  StageType.retrieval: {
    'title': '채취 예정',
    'subtitle': '난자 채취 시술',
  },
  StageType.waiting: {
    'title': '이식 대기',
    'subtitle': '배아 배양 중',
  },
  StageType.transfer: {
    'title': '이식 예정',
    'subtitle': '배아 이식 시술',
  },
  StageType.result: {
    'title': '판정일',
    'subtitle': 'hCG 검사',
  },
};
```

### UI 예시
```
기록 탭 상태: 과배란 완료, 채취 D-2 예정
→ 홈 "곧 만나요":
   🥚 채취 예정
   난자 채취 시술        D-2

기록 탭 상태: 이식 대기 중, 이식 D-5 예정
→ 홈 "곧 만나요":
   🎯 이식 예정
   배아 이식 시술        D-5
```

---

## 4. 캘린더 상세 정보 개선

### 4-1. 민트색 제거
- 캘린더 내 완료 표시 점: 민트 → **보라색** 또는 **초록**
- 미완료 표시: 빨간 점 유지

### 4-2. 주사 부위 표시 (왼쪽/오른쪽)
```
Before:
✓ FSH 주사

After:
✓ FSH 주사 · 오전 08:00 · 왼쪽
```

### 4-3. 투약 시간 표시
```
Before:
✓ 아스피린
✗ 메트포르민

After:
✓ 아스피린 · 오전 07:05 완료
✗ FSH 주사 · 오전 08:00 (미완료)
✗ 메트포르민 · 저녁 20:00 (미완료)
```

### 4-4. 지난 날짜 완료 처리 기능

**요구사항:**
- 지난 날짜의 약물도 완료 체크 가능
- 탭하면 완료/미완료 토글

**UI:**
```
┌─────────────────────────────────────────┐
│ 💊 12월 25일의 투약                     │
├─────────────────────────────────────────┤
│ ✗ 아스피린 · 오전 07:00        [완료]   │  ← 탭 가능
│ ✗ FSH 주사 · 오전 08:00        [완료]   │
│ ✓ 메트포르민 · 저녁 20:15 완료          │
└─────────────────────────────────────────┘
```

**또는 탭하면 바텀시트:**
```
┌─────────────────────────────────────────┐
│ 아스피린 · 12월 25일                    │
├─────────────────────────────────────────┤
│                                         │
│  이 약을 복용하셨나요?                  │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  ✓ 네, 복용했어요               │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │  ✗ 아니요, 건너뛰었어요         │   │
│  └─────────────────────────────────┘   │
│                                         │
│  복용 시간 (선택):                      │
│  [오전 07:00 ▼]                         │
│                                         │
└─────────────────────────────────────────┘
```

### 데이터 모델 업데이트
```dart
class MedicationLog {
  String medicationId;
  DateTime scheduledDate;      // 예정 날짜
  TimeOfDay scheduledTime;     // 예정 시간
  DateTime? completedAt;       // 실제 완료 시간 (null이면 미완료)
  MedicationStatus status;     // completed, skipped, pending
  String? injectionSide;       // 주사인 경우: 'left' / 'right'
  bool isRetroactive;          // 소급 입력 여부
}
```

---

## 요약

| # | 항목 | 수정 내용 |
|---|------|----------|
| 1 | 페이지 타이틀 | 하단바 명칭과 일치 (기록 탭 → "기록") |
| 2 | 민트색 제거 | 전체 앱에서 민트색 → 연보라/초록으로 대체 |
| 3 | 곧 만나요 동기화 | 기록 탭 진행 단계와 연동 |
| 4 | 캘린더 개선 | 주사 부위 표시, 투약 시간 표시, 지난 날짜 완료 가능 |
