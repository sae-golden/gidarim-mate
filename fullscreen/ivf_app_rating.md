# ì‹œí—˜ê´€ë©”ì´íŠ¸ - ì•± í‰ê°€ ìœ ë„ í”Œë¡œìš°

## ê°œìš”
ì‚¬ìš©ì ë³„ì ì— ë”°ë¼ í”Œë ˆì´ìŠ¤í† ì–´ ë¦¬ë·° ë˜ëŠ” í”¼ë“œë°± ë©”ì¼ë¡œ ë¶„ê¸°í•˜ëŠ” í‰ê°€ ì‹œìŠ¤í…œ

---

## í”Œë¡œìš° ìš”ì•½

```
[í‰ê°€ íŒì—…] â†’ ë³„ì  ì„ íƒ
                â”‚
                â”œâ”€ 4~5ì  â†’ í”Œë ˆì´ìŠ¤í† ì–´ ë¦¬ë·° ìœ ë„
                â”‚
                â””â”€ 1~3ì  â†’ í”¼ë“œë°± ë©”ì¼ ìœ ë„
```

---

## íŒì—… ë…¸ì¶œ ì¡°ê±´

| ì¡°ê±´ | ì„¤ëª… |
|------|------|
| ì•± ì‚¬ìš© 7ì¼ ì´ìƒ | ì–´ëŠ ì •ë„ ì‚¬ìš©í•œ ìœ ì € |
| ë³µìš© ì™„ë£Œ 10íšŒ ì´ìƒ | í™œì„± ìœ ì € |
| í•œ ë²ˆë„ í‰ê°€ ì•ˆ í•¨ | ì¤‘ë³µ ë…¸ì¶œ ë°©ì§€ |
| ë§ˆì§€ë§‰ íŒì—… í›„ 10ì¼ | "ë‚˜ì¤‘ì—" ì„ íƒí•œ ê²½ìš° |

---

## Step 1: í‰ê°€ ìš”ì²­ íŒì—…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”€â”€                    â”‚
â”‚                                         â”‚
â”‚                 ğŸŒ±                      â”‚
â”‚                                         â”‚
â”‚      ì‹œí—˜ê´€ë©”ì´íŠ¸ê°€ ë„ì›€ì´ ëë‚˜ìš”?       â”‚
â”‚                                         â”‚
â”‚         â˜†   â˜†   â˜†   â˜†   â˜†             â”‚
â”‚        íƒ­í•´ì„œ ë³„ì ì„ ë‚¨ê²¨ì£¼ì„¸ìš”          â”‚
â”‚                                         â”‚
â”‚              [ë‚˜ì¤‘ì—]                   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì½”ë“œ ê°€ì´ë“œ
```dart
showModalBottomSheet(
  context: context,
  builder: (context) => RatingRequestSheet(
    onRating: (int stars) {
      if (stars >= 4) {
        showStoreReviewSheet();
      } else {
        showFeedbackSheet();
      }
    },
    onLater: () {
      // 10ì¼ í›„ ë‹¤ì‹œ ë…¸ì¶œ
      saveRatingLaterDate();
      Navigator.pop(context);
    },
  ),
);
```

---

## Step 2-A: ê³ í‰ì  (4~5ì ) â†’ ìŠ¤í† ì–´ ë¦¬ë·° ìœ ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”€â”€                    â”‚
â”‚                                         â”‚
â”‚                 ğŸ’œ                      â”‚
â”‚                                         â”‚
â”‚            ê°ì‚¬í•©ë‹ˆë‹¤!                   â”‚
â”‚                                         â”‚
â”‚     í”Œë ˆì´ìŠ¤í† ì–´ì—ë„ ì‘ì› í•œë§ˆë””         â”‚
â”‚         ë‚¨ê²¨ì£¼ì‹œê² ì–´ìš”?                  â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚        ìŠ¤í† ì–´ì— ë¦¬ë·° ë‚¨ê¸°ê¸°          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚             [ë‹¤ìŒì— í• ê²Œìš”]             â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì½”ë“œ ê°€ì´ë“œ
```dart
// in_app_review íŒ¨í‚¤ì§€ ì‚¬ìš©
import 'package:in_app_review/in_app_review.dart';

final InAppReview inAppReview = InAppReview.instance;

void requestStoreReview() async {
  if (await inAppReview.isAvailable()) {
    inAppReview.requestReview();
  } else {
    // ìŠ¤í† ì–´ í˜ì´ì§€ë¡œ ì§ì ‘ ì´ë™
    inAppReview.openStoreListing();
  }
  
  // í‰ê°€ ì™„ë£Œ ì €ì¥ (ë‹¤ì‹œ ì•ˆ ëœ¨ê²Œ)
  saveRatingCompleted();
}
```

---

## Step 2-B: ì €í‰ì  (1~3ì ) â†’ í”¼ë“œë°± ìœ ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”€â”€                    â”‚
â”‚                                         â”‚
â”‚                 ğŸ™                      â”‚
â”‚                                         â”‚
â”‚        ì†Œì¤‘í•œ ì˜ê²¬ ê°ì‚¬í•´ìš”              â”‚
â”‚                                         â”‚
â”‚     ì–´ë–¤ ì ì´ ì•„ì‰¬ìš°ì…¨ëŠ”ì§€               â”‚
â”‚       ì•Œë ¤ì£¼ì‹œê² ì–´ìš”?                    â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚           ì˜ê²¬ ë³´ë‚´ê¸°                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚             [ë‹¤ìŒì— í• ê²Œìš”]             â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Step 3: í”¼ë“œë°± ì‘ì„± í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â†         ì˜ê²¬ ë³´ë‚´ê¸°                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ ì–´ë–¤ ì ì´ ì•„ì‰¬ìš°ì…¨ë‚˜ìš”?                 â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â”‚                                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚             ë³´ë‚´ê¸°                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Step 4: í”¼ë“œë°± ì „ì†¡ ì™„ë£Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   â”€â”€                    â”‚
â”‚                                         â”‚
â”‚                 ğŸ’œ                      â”‚
â”‚                                         â”‚
â”‚        ì˜ê²¬ ì˜ ë°›ì•˜ì–´ìš”!                 â”‚
â”‚                                         â”‚
â”‚    ë” ë‚˜ì€ ì•±ì´ ë˜ë„ë¡ ë…¸ë ¥í• ê²Œìš”        â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚              í™•ì¸                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í”¼ë“œë°± ì €ì¥ (Supabase)

### í…Œì´ë¸” ìƒì„±
```sql
CREATE TABLE feedbacks (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  stars INTEGER NOT NULL,
  feedback TEXT NOT NULL,
  app_version TEXT,
  platform TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- RLS ì •ì±…
ALTER TABLE feedbacks ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can insert own feedback"
ON feedbacks FOR INSERT
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Only admin can view feedbacks"
ON feedbacks FOR SELECT
USING (auth.jwt() ->> 'role' = 'admin');
```

### í”¼ë“œë°± ì €ì¥ ì½”ë“œ
```dart
Future<void> saveFeedback({
  required int stars,
  required String feedback,
}) async {
  await supabase.from('feedbacks').insert({
    'user_id': supabase.auth.currentUser?.id,
    'stars': stars,
    'feedback': feedback,
    'app_version': appVersion,
    'platform': Platform.isAndroid ? 'android' : 'ios',
  });
}
```

### (ì„ íƒ) Slack ì•Œë¦¼ ì¶”ê°€
Supabase Edge Functionìœ¼ë¡œ í”¼ë“œë°± ì €ì¥ ì‹œ Slack ì•Œë¦¼ ì „ì†¡ ê°€ëŠ¥

```
ğŸ”” ìƒˆ í”¼ë“œë°± ë„ì°©!
â­ 2ì 
ğŸ’¬ "ì•Œë¦¼ì´ ê°€ë” ì•ˆ ì™€ìš”"
ğŸ“± Android v1.0.2
```

---

## ë°ì´í„° ëª¨ë¸

```dart
class AppRatingState {
  bool hasRated;              // í‰ê°€ ì™„ë£Œ ì—¬ë¶€
  DateTime? lastPromptDate;   // ë§ˆì§€ë§‰ íŒì—… ë…¸ì¶œì¼
  int? givenStars;            // ì¤€ ë³„ì 
  int completedDoses;         // ë³µìš© ì™„ë£Œ íšŸìˆ˜
  DateTime firstUseDate;      // ì²« ì‚¬ìš©ì¼
}

// SharedPreferences ì €ì¥
class RatingPreferences {
  static const String hasRatedKey = 'has_rated';
  static const String lastPromptKey = 'last_rating_prompt';
  static const String givenStarsKey = 'given_stars';
  
  static Future<bool> shouldShowRatingPrompt() async {
    final prefs = await SharedPreferences.getInstance();
    
    // ì´ë¯¸ í‰ê°€í–ˆìœ¼ë©´ ì•ˆ ë³´ì—¬ì¤Œ
    if (prefs.getBool(hasRatedKey) ?? false) return false;
    
    // ë§ˆì§€ë§‰ íŒì—… í›„ 10ì¼ ì•ˆ ì§€ë‚¬ìœ¼ë©´ ì•ˆ ë³´ì—¬ì¤Œ
    final lastPrompt = prefs.getString(lastPromptKey);
    if (lastPrompt != null) {
      final lastDate = DateTime.parse(lastPrompt);
      if (DateTime.now().difference(lastDate).inDays < 10) return false;
    }
    
    return true;
  }
}
```

---

## ë³„ì  ìœ„ì ¯

```dart
class StarRating extends StatefulWidget {
  final Function(int) onRating;
  
  @override
  Widget build(BuildContext context) {
    return Row(
      mainAxisAlignment: MainAxisAlignment.center,
      children: List.generate(5, (index) {
        return GestureDetector(
          onTap: () => onRating(index + 1),
          child: Padding(
            padding: EdgeInsets.symmetric(horizontal: 8),
            child: Icon(
              index < _currentRating ? Icons.star : Icons.star_border,
              size: 40,
              color: Color(0xFF9B7ED9),  // ë³´ë¼ìƒ‰
            ),
          ),
        );
      }),
    );
  }
}
```

---

## ìš”ì•½

| í•­ëª© | ë‚´ìš© |
|------|------|
| ë…¸ì¶œ ì¡°ê±´ | 7ì¼ ì‚¬ìš© + 10íšŒ ë³µìš© + ë¯¸í‰ê°€ |
| 4~5ì  | í”Œë ˆì´ìŠ¤í† ì–´ ì¸ì•± ë¦¬ë·° |
| 1~3ì  | í”¼ë“œë°± í¼ (Supabase ì €ì¥) |
| ì¬ë…¸ì¶œ | "ë‚˜ì¤‘ì—" ì„ íƒ ì‹œ 10ì¼ í›„ |
| UI | ë°”í…€ì‹œíŠ¸ (ìŠ¬ë¼ì´ë“œ ì—…) |

---

## íŒ¨í‚¤ì§€

```yaml
dependencies:
  in_app_review: ^2.0.8      # ìŠ¤í† ì–´ ë¦¬ë·°
  url_launcher: ^6.2.5       # ì´ë©”ì¼ ë°œì†¡
  shared_preferences: ^2.2.2 # í‰ê°€ ìƒíƒœ ì €ì¥
```
